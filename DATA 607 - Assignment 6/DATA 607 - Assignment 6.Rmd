---
title: "DATA 607 - Assignment 6"
author: "Julian Adames-Ng"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

This R script shows how to connect to the New York Times Books API to pull in data on the current bestsellers in the "hardcover fiction" category. It sends an HTTP request to the API, retrieves the data in JSON format, and then processes it into a structured R dataframe. This dataframe lets you easily access bestseller details for further analysis or visualization. The script uses the httr, jsonlite, and dplyr libraries to manage HTTP requests, parse JSON, and manipulate the data.

## Load the Necessary Libraries

We will use the 'httr', 'jsonlite', and 'dplyr' libraries to accomplish the task.

```{r }

rm(list = ls())

library(httr)
library(jsonlite)
library(dplyr)

```

## Send GET Request

This line sends an HTTP GET request to the NYT Books API endpoint. The URL includes a specified list name (hardcover-fiction) and the API key to access the resource. The GET() function retrieves a 'response' object containing the API response. The output is stored in the hardcover_fiction object.


```{r }

#send GET request
hardcover_fiction <- GET("https://api.nytimes.com/svc/books/v3/lists/current/hardcover-fiction.json?api-key=BY6Gsz06dAoYqPnuLpn6qekscvbJUxff")

```

## Parsing JSON Data

This line extracts the JSON content from the API response and converts it into a readable format in R.

```{r }

#extract and parse JSON data
json_data <- content(hardcover_fiction, as = "text") %>%
  fromJSON(flatten = TRUE)

head(json_data)

```

## Transforming JSON to Data Frame

In this step, the script targets the part of the JSON data that holds the book details (json_data$results$books) and converts it into a dataframe with as.data.frame(). This books_data dataframe then makes it easier to handle, manipulate, and analyze the information efficiently.

```{r }

#create data frame from book data
books_data <- as.data.frame(json_data$results$books)

```

## Displaying the Data Structure (a)

This line gives a structural summary of books_data, showing each columnâ€™s name, data type, and a quick preview of its values. This was use to confirm  that the JSON data was parsed accurately.

```{r }

str(books_data)

```

## Displaying the Data Structure (b)

Here I use the head() function to take a glimpse at the R-read data frame.

```{r }

head(books_data)

```

# Conclusion

In conclusion, this script effectively pulls data from the New York Times Books API, organizes it into an R dataframe, and confirms the structure and content. With the data in this format, you can easily analyze, visualize, or further manipulate the current bestseller information. This method can also be adjusted to work with other NYT API endpoints or similar JSON-based APIs, providing a flexible way to manage external data sources in R.
